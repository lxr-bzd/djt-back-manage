<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/main.css"/>
	</head>
	<body>
		<!--後臺表-->
		<section class="backstage_wrap">
			<div class="backstage_box">
				<h2>歷史記錄匯總表</h2>
				<!--數據表-->
				<div class="clearfix history_total_table">
					
					<!--第壹組-->
					<table border="1">
						<tr><th colspan="1" rowspan="2">編號</th><th colspan="1" rowspan="2">序號</th><th colspan="20">列隊結果</th><th colspan="1" rowspan="2" class="red">列隊統計</th></tr>
						<tr class="group_class">
					    	<th>6</th>
							<th>7</th>
							<th>8</th>
							<th>9</th>
							<th>10</th>
							<th>11</th>
							<th>12</th>
							<th>13</th>
							<th>14</th>
							<th>15</th>
							<th>16</th>
							<th>17</th>
							<th>18</th>
							<th>19</th>
							<th>20</th>
							<th>21</th>
							<th>22</th>
							<th>23</th>
							<th>24</th>
							<th>25</th>
						</tr>
					  	<!--數據行--001-->
					  	<tbody id="main_group">
					  	<tr>
					  		<th>1</th>
					  		<th>180</th>
					  		<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<th colspan="2" class="red">46</th>
					  	</tr>
						<tr>
					  		<th>2</th>
					  		<th>180</th>
					  		<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<th colspan="2" class="red"></th>
					  	</tr>
					  	</tbody>
						<!--統計-->
						<tr class="tr_red" id="yCount_group">
							<th colspan="2">結果匯總</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<th colspan="1"></th>
						</tr>
						<tr>
							<th colspan="2" rowspan="2"><a title="導出表格" href="javascript:tableExport()">全表導出</a></th>
							<th>6</th>
							<th>7</th>
							<th>8</th>
							<th>9</th>
							<th>10</th>
							<th>11</th>
							<th>12</th>
							<th>13</th>
							<th>14</th>
							<th>15</th>
							<th>16</th>
							<th>17</th>
							<th>18</th>
							<th>19</th>
							<th>20</th>
							<th>21</th>
							<th>22</th>
							<th>23</th>
							<th>24</th>
							<th>25</th>
							<th colspan="1" rowspan="2" class="red">列隊統計</th>
						</tr>
						<tr>
							<th colspan="20">列隊結果</th>
						</tr>
					</table>
					
				</div>
			</div>
			
		</section>
		
	</body>
	<script type="text/javascript" src="../js/jquery-1.12.4.min.js" ></script>
	<script type="text/javascript" src="../js/template-web.js"></script>
	<script type="text/javascript" src="../js/app.js"></script>
	<script type="text/javascript" src="../layui/layui.all.js"></script>
	<script type="text/javascript" src="js/gameCore.js"></script>
	
	<script type="text/javascript" src="../js/tableExport.min.js"></script>
	<script type="text/javascript" src="../js/jquery.base64.js"></script>
	
	<script type="text/javascript">
	$(function(){
		$app.request("../historyTotalData.do",function(json){
			var hs= json.map.hs;
			var html2 ="";
			var allSum = 0;
			var yQueue = [0,0,0,0,0  ,0,0,0,0,0 ,0,0,0,0,0 ,0,0,0,0,0];
			for (var j = 0; j < hs.length; j++) {
				html2+='<tr><th>'+hs[j].id+'</th><th>'+(hs[j].focus_row-2)+'</th>';
				var qcs = hs[j].queue_count.split(",");
				var xSum = 0;
				for (var i = 0; i < 25-5; i++) {
					var v =new Number(qcs[i]?qcs[i]:0);
					html2+='<td >'+v+'</td>'; 
					xSum+=v;
					yQueue[i]+=v;
				}
				allSum+=xSum;
				html2+='<th colspan="2" class="red">'+xSum+'</th></tr>';
			}
			$("#main_group").html(html2);
			
			var html = '<th colspan="2">結果匯總</th>';
			for (var i = 0; i < yQueue.length; i++) {
				html+='<td >'+yQueue[i]+'</td>';
			}
			html += '<th colspan="1">'+allSum+'</th>';
			$("#yCount_group").html(html);
			
		},{param:{uid:$app.getQueryStr("uid")}})
		
		
	});
	
	
	function tableExport(){
		layer.confirm('確認導出表格？', {
			  btn: ['是','否'] //按鈕
			}, function(i){
				layer.close(i);
				var tb = $("table");
				tb.tableExport({type:'excel',ignoreColumn: [],ignoreRow:[]
					, separator:';', escape:'false'
						 ,formats: ['xlsx']
				,fileName: '歷史記錄匯總表-'+new Date().format("yyyy-MM-dd")});
			}, function(){
			  
			});
		
		
	}
	
	</script>
</html>
